<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Historique</title>
  <link rel="icon" type="image/png" href="/static/dice.png">
  <link rel="stylesheet" href="/static/style.css">
  <script defer src="/static/client.js"></script>
</head>
<body>
  <div id="navbar"></div>

  <main class="content">
    <h1>ğŸ“œ Historique de mes Parties</h1>
    <div id="historyContainer" class="scrollable-history">Chargement...</div>

    <div class="back-link">
      <a href="/index.html">â¬…ï¸ Retour au jeu</a>
    </div>
  </main>

  <script>
    fetch('/static/header.html')
      .then(res => res.text())
      .then(html => document.getElementById('navbar').innerHTML = html)

    fetch('/api/history')
      .then(res => res.json())
      .then(data => {
        const div = document.getElementById('historyContainer')
        if (data.length === 0) {
          div.innerHTML = '<p>Aucune partie jouÃ©e.</p>'
          return
        }

        div.innerHTML = '<ul>' + data.map(game => `
          <li style="margin-bottom: 15px;">
            <b>ğŸ“… ${new Date(game.date_played).toLocaleString()}</b><br>
            ğŸ‘¤ Adversaire : ${game.opponent}<br>
            âš”ï¸ RÃ©sultat :
              ${game.wins > game.losses ? 'âœ… Victoire' : game.wins < game.losses ? 'âŒ DÃ©faite' : 'ğŸ¤ Ã‰galitÃ©'}<br>
            ğŸ§® Score : victoire : ${game.wins} / dÃ©faite : ${game.losses} / Ã©galitÃ©s : ${game.draws}

          </li>
        `).join('') + '</ul>'
      })
      .catch(err => {
        document.getElementById('historyContainer').innerText = 'Erreur de chargement.'
        console.error(err)
      })
  </script>
</body>
</html>
